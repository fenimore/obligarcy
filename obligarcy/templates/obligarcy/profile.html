{% extends "obligarcy/base.html" %}

{% block content %}

{% if user.is_authenticated %}
<div class='row'>
  <div>
    <div class="media">
      <div class="media-left">
        <a href="/profile/">
                  {% if user.userprofile.picture %}

          <img class="media-object"
               src="{{ user.userprofile.picture.path }}" alt="Problem serving picture"/>
          {% endif %}
        </a>
      </div>
      <div class="media-body">
        <h4 class="media-heading">{{ user.username }}</h4>
        {{ user.userprofile.bio}}<br>
        {{user.userprofile.location}}
      </div>
    </div>
  </div>
</div>
<hr>
<div class='row'>
  <div class='col-md-4'>

    <h3>Submissions</h3>
    {% if posts %}
        <ul>
        {% for post in posts %}
            <li><a href="/submission/{{ post.id }}/">{{ post.body[:30] + '..' }}</a></li>
            @ {{ post.pub_date.date().strftime('%D - %A')}} <br>
            For deadline: {{ post.deadline_set.all().first()}}
            <hr>
        {% endfor %}
        </ul>
    {% else %}
        <p>This User has no submissions</p>
    {% endif %}
  </div>
  <div class='col-md-4'>
    <h3>Contracts</h3>
    {% if contracts %}
        <ul>
        {% for contract in contracts %}
            <li><a href="/contract/{{ contract.id }}/">{{ contract.preamble }}</a></li>
            Deadline: {{ contract.end_date.strftime('%D')}}
            <hr>
        {% endfor %}
        </ul>
    {% else %}
        <p>This User has no (active) contracts</p>
    {% endif %}
  </div>
  <div class='col-md-4'>
    <h3>Up Coming Deadlines</h3>
    {% if deadlines %}
        <ul>
        {% for deadline in deadlines %}
        Deadline: {{ deadline.deadline.strftime('%D') }}
            <li>Contract: <a href="/contract/{{ deadline.contract.id }}/">{{ deadline.contract.preamble[:30] }}...</a></li>

            <hr>
        {% endfor %}
        </ul>
    {% else %}
        <p>This User has no (active) contracts</p>
    {% endif %}

    {% else %}
        <p>You are Not Authenticated!</p>
    {% endif %}
  </div>
</div>



{% endblock content %}
